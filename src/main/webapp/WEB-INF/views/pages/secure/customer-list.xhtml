<?xml version='1.0' encoding='UTF-8' ?>
<html xmlns="http://www.w3.org/1999/xhtml" 
	xmlns:h="http://java.sun.com/jsf/html" 
	xmlns:f="http://java.sun.com/jsf/core" 
	xmlns:ui="http://java.sun.com/jsf/facelets" 
	xmlns:p="http://primefaces.org/ui"
	xmlns:sec="http://www.springframework.org/security/tags">

<ui:composition template="/WEB-INF/views/templates/main-template.xhtml">
	<ui:param name="pageTitle" value="#{msg['customer-list']}" />
	<ui:define name="content">

		<p:dataTable id="customers" var="customer" value="#{customerBean.customers}" 
					 rows="15" paginator="true" paginatorPosition="bottom" lazy="true">
			
			
			
			<p:column headerText="#{msg['gender']}" >
				<h:outputText value="#{msg['GenderType.'.concat(customer.gender)]}" />
			</p:column>
			<p:column headerText="#{msg['name']}" sortBy="#{customer.name}">
				<h:outputText value="#{customer.name}" />
			</p:column>
			<p:column headerText="#{msg['surname']}">
				<h:outputText value="#{customer.surname}" />
			</p:column>
			<p:column headerText="#{msg['birth-year']}">
				<h:outputText value="#{customer.birthYear}" />
			</p:column>
			<p:column headerText="#{msg['phone']}">
				<h:outputText value="#{customer.phone}" />
			</p:column>
			
			<p:column headerText="#{msg['actions']}">
				<p:commandButton action="pretty:edit-customer" title="#{msg['edit']}" icon="fa fa-edit" immediate="true" ajax="false">
					<f:setPropertyActionListener target="#{editCustomerBean.customerId}" value="#{customer.id}"/>
				</p:commandButton>
				
				<sec:authorize access="hasAnyRole('ROLE_DIRECTOR')">
					<p:commandButton icon="fa fa-remove" title="#{msg['remove']}" action="#{customerBean.removeCustomer(customer)}" update="@form:customers"/>
				</sec:authorize>
			</p:column>
			
			<f:facet name="footer">
    	        <p:commandButton icon="fa fa-plus" value="#{msg['new-customer']}" action="pretty:edit-customer">
    	        	<f:setPropertyActionListener target="#{editCustomerBean.customerId}" value="0" ajax="false" immediate="true"/>
    	        </p:commandButton>
	        </f:facet>
			
		</p:dataTable>
		

	</ui:define>
</ui:composition>
</html>

